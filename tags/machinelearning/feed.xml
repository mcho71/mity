<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>
    MachineLearning on 
    Mcho
    </title>
    <link>https://mcho.dev/tags/machinelearning/</link>
    <description>Recent content in MachineLearning
    on Mcho</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-JP</language>
    
    
    <copyright>&amp;copy; mcho 2019</copyright>
    <lastBuildDate>Fri, 19 Feb 2021 10:47:40 +0900</lastBuildDate>
    
    
        <atom:link href="https://mcho.dev/tags/machinelearning/feed.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>OpenAIの強化学習シミュレータGymを触ってみる</title>
      <link>https://mcho.dev/notes/openai%E3%81%AE%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BFgym%E3%82%92%E8%A7%A6%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B/</link>
      <pubDate>Fri, 19 Feb 2021 10:47:40 +0900</pubDate>
      
      <guid>https://mcho.dev/notes/openai%E3%81%AE%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BFgym%E3%82%92%E8%A7%A6%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B/</guid>
      <description><![CDATA[強化学習のシミュレーターを作ってみたいなということで、強化学習のフレームワークである Gym を動かしてみようと思いました。 なにはともあれ Python の環境を用意する Python 自体普段は触っていないので手探りでした。結局はpy]]></description>
      <content:encoded><![CDATA[<p>強化学習のシミュレーターを作ってみたいなということで、強化学習のフレームワークである Gym を動かしてみようと思いました。</p>
<h2 id="なにはともあれ-python-の環境を用意する">なにはともあれ Python の環境を用意する</h2>
<p>Python 自体普段は触っていないので手探りでした。結局は<code>pyenv</code>+<code>venv</code>で落ち着いています。</p>
<p>手元環境は</p>
<ul>
<li>MacOS Monterey 12.3.1</li>
<li>Homebrew</li>
</ul>
<p>です。</p>
<p>Python 本体、複数バージョンを管理するための候補は</p>
<ul>
<li>brew</li>
<li>pyenv</li>
<li>miniconda</li>
<li>anaconda</li>
</ul>
<p>でした。</p>
<p>仮想環境の候補としては</p>
<ul>
<li>venv</li>
<li>pyenv-virtualenv</li>
<li>pipenv</li>
<li>miniconda</li>
<li>anaconda</li>
</ul>
<p>がありました。</p>
<p>Python 本体、複数バージョンの管理は、他の言語でも使い慣れている<code>pyenv</code>を選びました。</p>
<p>仮想環境は、<code>venv</code>を使うことにしたのは、公式の<a href="https://docs.python.org/ja/3/library/venv.html?highlight=env#an-example-of-extending-envbuilder" target="_blank" rel="nofollow noopener">venv &mdash; 仮想環境の作成 — Python 3.10.4 ドキュメント</a>で紹介されていたことが決め手でした。
以前 Python を触っていたときに使っていた<code>pipenv</code>は開発が止まっていたこと、<code>conda</code>系は動かすだけだとコマンド追加などで過剰に感じたことも、後押ししました。
<code>pyenv-virutualenv</code>は<code>venv</code>と同じ動作で使えますが、標準ライブラリとして取り込まれている<code>venv</code>の方がなんとなく軽くてエラーが発生しないかなと思ってます。
<code>venv</code>と<code>virtualenv</code>の違いは、<a href="https://virtualenv.pypa.io/en/latest/" target="_blank" rel="nofollow noopener">Virtualenv — virtualenv 20.14.2.dev2+g8d78ee0 documentation</a>より、機能の多さ、動作の軽さのようです。</p>
<p>以下開発環境構築時のコマンドラインです。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">brew install pyenv pyenv-virtualenv
<span class="c1"># 以下二行を.bash_profile等に書き込む</span>
<span class="c1"># eval &#34;$(pyenv init -)&#34;</span>
<span class="c1"># eval &#34;$(pyenv virtualenv-init -)&#34;</span>

pyenv install 3.8.8

<span class="nb">cd</span> path/to/project

pyenv <span class="nb">local</span> 3.8.8
python -m venv &lt;venvname&gt;
<span class="nb">source</span> &lt;venvname&gt;/bin/activate
pip install --upgrade pip
</code></pre></div><h2 id="gym-を動かす">Gym を動かす</h2>
<p>以下リンクを参考に、Gym を動かします。</p>
<ul>
<li><a href="https://gym.openai.com/" target="_blank" rel="nofollow noopener">Gym</a></li>
<li><a href="http://gym.openai.com/docs/" target="_blank" rel="nofollow noopener">Gym Docs</a></li>
<li><a href="https://github.com/openai/retro" target="_blank" rel="nofollow noopener">openai/retro: Retro Games in Gym</a></li>
</ul>
<h2 id="readme-に沿って動かしてみる">README に沿って動かしてみる</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git clone https://github.com/openai/gym
pip install -e gym
// examples/agentsにあるプログラムを実行してみる
python examples/agents/cem.py
</code></pre></div><p>実行されると棒が倒れないように台座を動かしている。






<picture>
  <source media="(max-width: 480px)" srcset="/notes/openai%E3%81%AE%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BFgym%E3%82%92%E8%A7%A6%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B/image/2021-02-19-11-25-21_hubedf350c6a7c5566baacd6e43c6e5b00_57229_480x0_resize_q75_bgffffff_box_3.jpg 480w">
  <source media="(max-width: 768px)" srcset="/notes/openai%E3%81%AE%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BFgym%E3%82%92%E8%A7%A6%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B/image/2021-02-19-11-25-21_hubedf350c6a7c5566baacd6e43c6e5b00_57229_768x0_resize_q75_bgffffff_box_3.jpg 768w">
  <source media="(max-width: 1024px)" srcset="/notes/openai%E3%81%AE%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BFgym%E3%82%92%E8%A7%A6%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B/image/2021-02-19-11-25-21_hubedf350c6a7c5566baacd6e43c6e5b00_57229_1024x0_resize_q75_bgffffff_box_3.jpg 1024w">
  <img src="/notes/openai%E3%81%AE%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BFgym%E3%82%92%E8%A7%A6%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B/image/2021-02-19-11-25-21.png" alt="cem.py" decoding="async" loading="lazy">
</picture>
</p>
<p><code>examples/agents</code>配下は以下の通り。<code>cem.py</code>のみ学習アルゴリズムが実行されている</p>
<h3 id="random_agentpy"><code>random_agent.py</code></h3>
<p>毎回リセットして、RandomAgent.act を実行。</p>
<p><a href="https://github.com/openai/gym/blob/4c460ba6c8959dd8e0a03b13a1ca817da6d4074f/examples/agents/random_agent.py#L39-L45" target="_blank" rel="nofollow noopener">https://github.com/openai/gym/blob/4c460ba6c8959dd8e0a03b13a1ca817da6d4074f/examples/agents/random_agent.py#L39-L45</a>
<a href="https://github.com/openai/gym/blob/4c460ba6c8959dd8e0a03b13a1ca817da6d4074f/examples/agents/random_agent.py#L6-L13" target="_blank" rel="nofollow noopener">https://github.com/openai/gym/blob/4c460ba6c8959dd8e0a03b13a1ca817da6d4074f/examples/agents/random_agent.py#L6-L13</a></p>
<h3 id="cempy"><code>cem.py</code></h3>
<p>交差エントロピー<a href="https://mathwords.net/kousaentropy#:~:text=%E4%BA%A4%E5%B7%AE%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AD%E3%83%94%E3%83%BC%E3%81%AF%E3%80%81%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92,%E8%80%83%E3%81%88%E3%82%8B%E3%81%93%E3%81%A8%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82" target="_blank" rel="nofollow noopener">交差エントロピーの例と微分の計算 - 具体例で学ぶ数学</a>を学習アルゴリズムとして使っています。</p>
<p>ここでモデルのトレーニングをしていて、cem メソッドが交差エントロピーの計算処理本体となってます。
<a href="https://github.com/openai/gym/blob/3bd5ef71c2ca3766a26c3dacf87a33a9390ce1e6/examples/agents/cem.py#L87-L93" target="_blank" rel="nofollow noopener">https://github.com/openai/gym/blob/3bd5ef71c2ca3766a26c3dacf87a33a9390ce1e6/examples/agents/cem.py#L87-L93</a></p>
<h3 id="keyboard_agentpy"><code>keyboard_agent.py</code></h3>
<p>キーボード入力を受付けているようですが、依存パッケージ足らなくて動きませんでした。</p>
<h2 id="openairetro-retro-games-in-gymhttpsgithubcomopenairetroを動かしてみる"><a href="https://github.com/openai/retro" target="_blank" rel="nofollow noopener">openai/retro: Retro Games in Gym</a>を動かしてみる</h2>
<p><a href="https://retro.readthedocs.io/en/latest/getting_started.html" target="_blank" rel="nofollow noopener">Getting Started — Gym Retro documentation</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">pip install gym-retro

python -m retro.examples.brute --game Airstriker-Genesis
</code></pre></div><p><a href="https://github.com/openai/retro/tree/master/retro/examples" target="_blank" rel="nofollow noopener">retro/retro/examples at master · openai/retro</a>
に評価アルゴリズムの例があります。評価アルゴリズムはライブラリとして呼び出しを行います。<code>python -m retro.examples.brute --game Airstriker-Genesis</code>では<code>retro.example.brute</code>が指定されています。</p>
<p>以下のコードで使えるゲーム一覧を表示できます。ROM が同梱されているわけではなく、別個用意する必要があるようです。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">retro</span>
<span class="nb">print</span><span class="p">(</span><span class="n">retro</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">list_games</span><span class="p">()))</span>
</code></pre></div><h2 id="終わりに">終わりに</h2>
<p>Python の環境構築から実際に動かすまでやってみました。Python の実行環境を用意するのは毎回少し調べたり、手間がかかっていましたが、今回は公式のドキュメントに<code>venv</code>があったのですんなり行きました。</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ML Study Jams Vol.3</title>
      <link>https://mcho.dev/notes/launching_into_machine_learning_%E5%8F%97%E8%AC%9B%E3%83%AD%E3%82%B0/</link>
      <pubDate>Tue, 27 Aug 2019 21:51:23 +0900</pubDate>
      
      <guid>https://mcho.dev/notes/launching_into_machine_learning_%E5%8F%97%E8%AC%9B%E3%83%AD%E3%82%B0/</guid>
      <description><![CDATA[Launching into Machine Learning ML の開始について このコースは、機械学習の用語や、普及の歴史、モデル作成のためのコードや知識を身につけます コースには最適化モジュールがあり、学習問題が用意位されている。最急降下法を使います。 実践]]></description>
      <content:encoded><![CDATA[<h1 id="launching-into-machine-learning">Launching into Machine Learning</h1>
<h2 id="ml-の開始について">ML の開始について</h2>
<ul>
<li>このコースは、機械学習の用語や、普及の歴史、モデル作成のためのコードや知識を身につけます</li>
<li>コースには最適化モジュールがあり、学習問題が用意位されている。最急降下法を使います。</li>
</ul>
<h2 id="実践的な-ml-について">実践的な ML について</h2>
<ul>
<li>歴史を振り返って実践のときに参考にできるようします</li>
<li>グーグルが全プロジェクトに機械学習を取り入れる取り組みについて紹介します</li>
</ul>
<h2 id="教師あり学習">教師あり学習</h2>
<h3 id="教師あり学習-1">教師あり学習</h3>
<ul>
<li>モデルになにを学習させるか</li>
<li>これまで発達した理由を理解します</li>
<li>教師なし学習は発見するもの</li>
<li>教師あり学習はラベルの特徴でプロットされている</li>
<li>表データの行がデータとして、ラベル、連続値、分類値のカラムが存在し、ラベルは予測対象、連続値は回帰モデル、分類値は分類モデルになる
<ul>
<li>２つの分類値の場合バイナリモデルとかともいう</li>
</ul>
</li>
<li>分類モデルでも、その件数を予測したりする場合は回帰でできる</li>
</ul>
<h3 id="回帰と分類">回帰と分類</h3>
<p>


<picture>
  <img src="/img/2019-08-27-22-24-17.png" alt="レストランチップ 男女の分布" decoding="async" loading="lazy">
</picture>
</p>
<ul>
<li>線形だとひどい分類予測になってしまいそう</li>
<li>非線形の方が、分類には適してそう</li>
</ul>
<h2 id="ml-の歴史">ML の歴史</h2>
<h3 id="機械学習小史-線形回帰">機械学習小史: 線形回帰</h3>
<ul>
<li>線形回帰とか NW とか機械学習の歴史</li>
<li>線形回帰は惑星の動きやえんどう豆のさやに対する実の大きさを予測するために使われていた</li>
<li>線形回帰</li>
</ul>
<h3 id="機械学習小史-パーセプトロン">機械学習小史: パーセプトロン</h3>
<ul>
<li>1940 年代にフランク ローゼンブラットが 人間の脳のニューロンの計算モデルとして パーセプトロンを考案し 簡単な機能の学習方法を示した</li>
<li>何度か壁にあたって忘れ去られたりもしてる</li>
</ul>
<h3 id="機械学習小史-ニューラルネットワーク">機械学習小史: ニューラルネットワーク</h3>
<ul>
<li>パーセプトロンを複数個つなげたような形の学習モデル</li>
</ul>
<h3 id="機械学習小史-決定ツリー">機械学習小史: 決定ツリー</h3>
<ul>
<li>ID3 や C4.5</li>
<li>貪欲アルゴリズム</li>
<li>DNN では実際の各層が結びついている</li>
<li>データの入れ物を決めてみよう</li>
<li>yes/no で振り分けていく</li>
<li>バイナリ分類器のようなもの</li>
<li>ツリーを再帰的に作るのは、NW の線形分類器ノードの層に似てる</li>
<li>実際にツリーの質問は入ってきたデータに対して一般化しておきたい</li>
</ul>
<h3 id="機械学習小史-カーネル-メソッド">機械学習小史: カーネル メソッド</h3>
<ul>
<li>SVM を含むジャンル</li>
<li>SVM はマージンをヒンジ関数を使って最大化する</li>
<li>次元が多い場合や 予測変数による 応答の予測精度が非常に高い場合 SVM は優れた効果を発揮します</li>
</ul>
<h3 id="機械学習小史-ランダム-フォレスト">機械学習小史: ランダム フォレスト</h3>
<ul>
<li>マシンの性能が上がると様々なモデルを組み合わせるようになった　アンサンブル法</li>
<li>ランダムフォレストはアンサンブル法の一つ</li>
</ul>
<h3 id="機械学習小史-最新のニューラル-ネットワーク">機械学習小史: 最新のニューラル ネットワーク</h3>
<ul>
<li>DNN</li>
<li>取り掛かるときに特に大事なこと
<ul>
<li>データ量</li>
<li>実験</li>
<li>一般化</li>
</ul>
</li>
</ul>
<h4 id="ゲレンデの混雑率予想の回答">ゲレンデの混雑率予想の回答</h4>
<p>混雑レベルを予測するには、ゲレンデを滑っている人数を予測できれば良い。</p>
<p>分かっていることは、リフト券を購入した利用客のレベルと、過去の積雪量(誤訳？前のビデオはそれまでの積雪量)。</p>
<p>各利用客レベルとそれまでの積雪量を用いて、ゲレンデに滞在している確率を求める回帰モデルを作成する。</p>
<p>上記モデルに、レベルと、刻々と変化しているそれまでの積雪量を与えて、ゲレンデに滞在している確率を求め、各利用客レベルごとのリフト券購入数と掛け合わせれば、ゲレンデを滑っている人数を予測できそう。</p>
<h2 id="最適化について">最適化について</h2>
<h3 id="機械学習モデルの定義">機械学習モデルの定義</h3>
<ul>
<li>モデルはパラメータとハイパーパラメータを使った数学的関数</li>
<li>特徴量と呼ばれる独立変数が変化するとラベルと呼ばれる従属変数も同量だけ変化する</li>
<li>2 次元領域の直線　 y = mx + b</li>
<li>この考え方は任意の高次元まで拡張できる</li>
</ul>
<h3 id="出生率データセットの概要">出生率データセットの概要</h3>
<ul>
<li>赤ちゃんが生まれた際に治療が必要になるか予測する必要性</li>
<li>特徴量としての候補
<ul>
<li>赤ちゃんの体重</li>
<li>出生時間</li>
<li>母親の年齢</li>
</ul>
</li>
<li>うち赤ちゃんの体重と母親の年齢は観測可能なので特徴量として使用できる</li>
<li>体重は連続値</li>
<li>分布図に線形の先を引いてみてもいまいちに見える</li>
</ul>
<h3 id="損失関数の概要">損失関数の概要</h3>
<ul>
<li>モデルの最適なハイパーパラメタを求めるには</li>
<li>損失関数を使う</li>
<li>平均二乗誤差</li>
<li>クラス分類の場合は交差エントロピー損失を計算する</li>
</ul>
<h3 id="勾配降下法">勾配降下法</h3>
<ul>
<li>損失関数の凹凸表面をどのようにして最小値に下っていくのか
<ul>
<li>等高線のようなもの</li>
</ul>
</li>
<li>学習率次第で遅くなったり、最小値にたどり着けなかったりする</li>
<li>進む方向は、一番傾斜の深い方向</li>
</ul>
<h3 id="損失関数のトラブルシューティング">損失関数のトラブルシューティング</h3>
<ul>
<li>時間と損失軸の損失曲線を書いてみる</li>
<li>反比例の形でないときは問題あり</li>
<li>一般に学習率は 1 より遥かに小さい値</li>
</ul>
]]></content:encoded>
    </item>
    
  </channel>
</rss>